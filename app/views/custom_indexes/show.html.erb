<h1><%= @custom_index.name %></h1>

<%= @settings = @custom_index.settings %>

<table class="table table-striped">
  <tbody>
    <tr>
      <th scope="row">Формирование базы расчёта</th>
      <td><%= @settings[IndexCalculator::REVIEW_PERIOD] == IndexCalculator::REVIEW_PERIOD_Q ? "раз в квартал" : "раз в год" %></td>
    </tr>
    <% @settings[IndexCalculator::FILTERS].each do |filter_key, filter_value| %>
      <tr>
        <% if filter_key == IndexCalculator::FILTERS_LL %>
          <th scope="row">Фильтр по уровню листинга</th>
          <td><%= filter_value.map(&:to_s).join(", ") %></td>
        <% elsif filter_key == IndexCalculator::FILTERS_SECTOR %>
          <th scope="row">Фильтр по секторам</th>
          <td><%= ShareSector.where(id: filter_value).order(:name).pluck(:name).join(", ") %></td>
        <% elsif filter_key == IndexCalculator::FILTERS_TICKERS %>
          <th scope="row">Фильтр по акциям</th>
          <td><%= filter_value.join(", ") %></td>
        <% end %>
      </tr>
    <% end %>
    <tr>
      <th scope="row">Отбор в индекс</th>
      <% selection_key, selection_value = *@settings[IndexCalculator::SELECTION] %>
      <% if selection_key == IndexCalculator::SELECTION_MARKET_CAP %>
        <td>Топ <%= selection_value[IndexCalculator::SELECTION_TOP] %> капитализации</td>
      <% else %>
        <td>Моментум за последние <%= selection_value[IndexCalculator::SELECTION_PERIOD] %> дней относительно <%= selection_value[IndexCalculator::SELECTION_BENCHMARK] %></td>
      <% end %>
    </tr>
    <tr>
      <th scope="row">Взвешивание</th>
      <td><%= @settings[IndexCalculator::WEIGHING] == IndexCalculator::WEIGHING_EQUAL ? "Равное" : "По рыночной капитализации" %></td>
    </tr>
  </tbody>
</table>
